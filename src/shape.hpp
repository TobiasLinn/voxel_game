#ifndef SHAPE_HPP
#define SHAPE_HPP

#include <vector>

#include "util.hpp"

namespace vxg {

template<i32 N>
struct face {
    // plane equation: nx, ny, nz, b
    alignas(4) i8 n[4];

    // plane equations through edges (perp. to main plane)
    alignas(4) i8 nn[N][4];
};

struct shape {
    // face indices
    std::vector<i32> tr;
    std::vector<i32> rc;
};

static const face<3> triangles[112] = {
    face<3> {
        { 0, 0, -1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, -1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 1, -1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 1, -1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, -1, 0 },
        {
            { 1, 0, 0, 0 },
            { 0, -1, 0, 1 },
            { -1, 1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, 0 },
        {
            { 1, 0, 0, 0 },
            { 0, -1, 0, 1 },
            { -1, 1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, -1, 0 },
        {
            { 1, 1, 0, -1 },
            { 0, -1, 0, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, 0, 1, 0 },
        {
            { 1, 1, 0, -1 },
            { 0, -1, 0, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, 1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<3> {
        { -1, -1, -1, 1 },
        {
            { -1, -1, 2, 1 },
            { 2, -1, -1, 1 },
            { -1, 2, -1, 1 }
        }
    },
    face<3> {
        { 1, 1, 1, -1 },
        {
            { -1, -1, 2, 1 },
            { 2, -1, -1, 1 },
            { -1, 2, -1, 1 }
        }
    },
    face<3> {
        { -1, 1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, -2, 2 },
            { 1, 1, 0, 0 }
        }
    },
    face<3> {
        { 1, -1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, -2, 2 },
            { 1, 1, 0, 0 }
        }
    },
    face<3> {
        { -1, 0, -1, 1 },
        {
            { -1, 0, 1, 1 },
            { 1, -2, -1, 1 },
            { 0, 2, 0, 0 }
        }
    },
    face<3> {
        { 1, 0, 1, -1 },
        {
            { -1, 0, 1, 1 },
            { 1, -2, -1, 1 },
            { 0, 2, 0, 0 }
        }
    },
    face<3> {
        { 0, 1, 1, -1 },
        {
            { 0, -1, 1, 1 },
            { -2, 1, -1, 1 },
            { 2, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, -1, -1, 1 },
        {
            { 0, -1, 1, 1 },
            { -2, 1, -1, 1 },
            { 2, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, 1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 1, 0, -1, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 1, 0, -1, 0 }
        }
    },
    face<3> {
        { -1, 0, 1, 0 },
        {
            { 1, 0, 1, 0 },
            { -1, -2, -1, 2 },
            { 0, 2, 0, 0 }
        }
    },
    face<3> {
        { 1, 0, -1, 0 },
        {
            { 1, 0, 1, 0 },
            { -1, -2, -1, 2 },
            { 0, 2, 0, 0 }
        }
    },
    face<3> {
        { -1, -1, 0, 1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, -2, 1 },
            { -1, 1, 0, 1 }
        }
    },
    face<3> {
        { 1, 1, 0, -1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, -2, 1 },
            { -1, 1, 0, 1 }
        }
    },
    face<3> {
        { -1, 1, 1, 0 },
        {
            { 1, -1, 2, 0 },
            { -2, -1, -1, 3 },
            { 1, 2, -1, 0 }
        }
    },
    face<3> {
        { 1, -1, -1, 0 },
        {
            { 1, -1, 2, 0 },
            { -2, -1, -1, 3 },
            { 1, 2, -1, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<3> {
        { 0, 1, 1, -1 },
        {
            { 0, -1, 1, 1 },
            { -2, 0, 0, 2 },
            { 2, 1, -1, -1 }
        }
    },
    face<3> {
        { 0, -1, -1, 1 },
        {
            { 0, -1, 1, 1 },
            { -2, 0, 0, 2 },
            { 2, 1, -1, -1 }
        }
    },
    face<3> {
        { 0, 1, 0, 0 },
        {
            { 1, 0, 0, 0 },
            { 0, 0, -1, 1 },
            { -1, 0, 1, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 0 },
        {
            { 1, 0, 0, 0 },
            { 0, 0, -1, 1 },
            { -1, 0, 1, 0 }
        }
    },
    face<3> {
        { 0, 1, 0, 0 },
        {
            { 1, 0, 1, -1 },
            { 0, 0, -1, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, -1, 0, 0 },
        {
            { 1, 0, 1, -1 },
            { 0, 0, -1, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, 1, 1, -1 },
        {
            { 2, 0, 0, 0 },
            { 0, 1, -1, 1 },
            { -2, -1, 1, 1 }
        }
    },
    face<3> {
        { 0, -1, -1, 1 },
        {
            { 2, 0, 0, 0 },
            { 0, 1, -1, 1 },
            { -2, -1, 1, 1 }
        }
    },
    face<3> {
        { 0, 1, 1, -1 },
        {
            { 2, -1, 1, -1 },
            { 0, 1, -1, 1 },
            { -2, 0, 0, 2 }
        }
    },
    face<3> {
        { 0, -1, -1, 1 },
        {
            { 2, -1, 1, -1 },
            { 0, 1, -1, 1 },
            { -2, 0, 0, 2 }
        }
    },
    face<3> {
        { 0, 1, -1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, -1, -1, 2 },
            { 2, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, -1, 1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, -1, -1, 2 },
            { 2, 0, 0, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 1, -1, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 1, -1, 0 }
        }
    },
    face<3> {
        { -1, -1, 0, 1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, 0, 1 },
            { -1, 1, -2, 1 }
        }
    },
    face<3> {
        { 1, 1, 0, -1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, 0, 1 },
            { -1, 1, -2, 1 }
        }
    },
    face<3> {
        { -1, 1, -1, 0 },
        {
            { -1, 1, 2, 0 },
            { -1, -2, -1, 3 },
            { 2, 1, -1, 0 }
        }
    },
    face<3> {
        { 1, -1, 1, 0 },
        {
            { -1, 1, 2, 0 },
            { -1, -2, -1, 3 },
            { 2, 1, -1, 0 }
        }
    },
    face<3> {
        { -1, 0, -1, 1 },
        {
            { -1, 0, 1, 1 },
            { 0, -2, 0, 2 },
            { 1, 2, -1, -1 }
        }
    },
    face<3> {
        { 1, 0, 1, -1 },
        {
            { -1, 0, 1, 1 },
            { 0, -2, 0, 2 },
            { 1, 2, -1, -1 }
        }
    },
    face<3> {
        { 0, 1, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 0 },
        {
            { 0, 1, 0, 0 },
            { 0, 0, -1, 1 },
            { 0, -1, 1, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, 0 },
        {
            { 0, 1, 0, 0 },
            { 0, 0, -1, 1 },
            { 0, -1, 1, 0 }
        }
    },
    face<3> {
        { -1, 0, -1, 1 },
        {
            { 0, 2, 0, 0 },
            { 1, 0, -1, 1 },
            { -1, -2, 1, 1 }
        }
    },
    face<3> {
        { 1, 0, 1, -1 },
        {
            { 0, 2, 0, 0 },
            { 1, 0, -1, 1 },
            { -1, -2, 1, 1 }
        }
    },
    face<3> {
        { -1, 0, 0, 0 },
        {
            { 0, 1, 1, -1 },
            { 0, 0, -1, 1 },
            { 0, -1, 0, 1 }
        }
    },
    face<3> {
        { 1, 0, 0, 0 },
        {
            { 0, 1, 1, -1 },
            { 0, 0, -1, 1 },
            { 0, -1, 0, 1 }
        }
    },
    face<3> {
        { -1, 0, -1, 1 },
        {
            { -1, 2, 1, -1 },
            { 1, 0, -1, 1 },
            { 0, -2, 0, 2 }
        }
    },
    face<3> {
        { 1, 0, 1, -1 },
        {
            { -1, 2, 1, -1 },
            { 1, 0, -1, 1 },
            { 0, -2, 0, 2 }
        }
    },
    face<3> {
        { 1, 1, -1, 0 },
        {
            { -1, 2, 1, 0 },
            { -1, -1, -2, 3 },
            { 2, -1, 1, 0 }
        }
    },
    face<3> {
        { -1, -1, 1, 0 },
        {
            { -1, 2, 1, 0 },
            { -1, -1, -2, 3 },
            { 2, -1, 1, 0 }
        }
    },
    face<3> {
        { -1, -1, 0, 1 },
        {
            { -1, 1, 0, 1 },
            { 0, 0, -2, 2 },
            { 1, -1, 2, -1 }
        }
    },
    face<3> {
        { 1, 1, 0, -1 },
        {
            { -1, 1, 0, 1 },
            { 0, 0, -2, 2 },
            { 1, -1, 2, -1 }
        }
    },
    face<3> {
        { -1, -1, 0, 1 },
        {
            { -1, 1, 2, -1 },
            { 0, 0, -2, 2 },
            { 1, -1, 0, 1 }
        }
    },
    face<3> {
        { 1, 1, 0, -1 },
        {
            { -1, 1, 2, -1 },
            { 0, 0, -2, 2 },
            { 1, -1, 0, 1 }
        }
    },
    face<3> {
        { 1, 1, 1, -2 },
        {
            { -2, 1, 1, 1 },
            { 1, 1, -2, 1 },
            { 1, -2, 1, 1 }
        }
    },
    face<3> {
        { -1, -1, -1, 2 },
        {
            { -2, 1, 1, 1 },
            { 1, 1, -2, 1 },
            { 1, -2, 1, 1 }
        }
    },
    face<3> {
        { 0, 0, -1, 1 },
        {
            { 0, 1, 0, 0 },
            { -1, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, -1 },
        {
            { 0, 1, 0, 0 },
            { -1, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<3> {
        { 0, 1, -1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, 0, 0, 2 },
            { 2, -1, -1, 0 }
        }
    },
    face<3> {
        { 0, -1, 1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, 0, 0, 2 },
            { 2, -1, -1, 0 }
        }
    },
    face<3> {
        { -1, 0, 1, 0 },
        {
            { 1, 0, 1, 0 },
            { 0, -2, 0, 2 },
            { -1, 2, -1, 0 }
        }
    },
    face<3> {
        { 1, 0, -1, 0 },
        {
            { 1, 0, 1, 0 },
            { 0, -2, 0, 2 },
            { -1, 2, -1, 0 }
        }
    },
    face<3> {
        { -1, -1, 1, 1 },
        {
            { 1, 1, 2, -1 },
            { 1, -2, -1, 2 },
            { -2, 1, -1, 2 }
        }
    },
    face<3> {
        { 1, 1, -1, -1 },
        {
            { 1, 1, 2, -1 },
            { 1, -2, -1, 2 },
            { -2, 1, -1, 2 }
        }
    },
    face<3> {
        { -1, 1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, 0, 2 },
            { 1, 1, -2, 0 }
        }
    },
    face<3> {
        { 1, -1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, 0, 2 },
            { 1, 1, -2, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 1, -1, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 1, -1, 0 }
        }
    },
    face<3> {
        { 0, 1, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 1, 0, -1, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 1, 0, -1, 0 }
        }
    },
    face<3> {
        { -1, 1, 0, 0 },
        {
            { 1, 1, 0, 0 },
            { 0, 0, -2, 2 },
            { -1, -1, 2, 0 }
        }
    },
    face<3> {
        { 1, -1, 0, 0 },
        {
            { 1, 1, 0, 0 },
            { 0, 0, -2, 2 },
            { -1, -1, 2, 0 }
        }
    },
    face<3> {
        { 1, -1, 1, -1 },
        {
            { 1, 2, 1, -1 },
            { 1, -1, -2, 2 },
            { -2, -1, 1, 2 }
        }
    },
    face<3> {
        { -1, 1, -1, 1 },
        {
            { 1, 2, 1, -1 },
            { 1, -1, -2, 2 },
            { -2, -1, 1, 2 }
        }
    },
    face<3> {
        { 1, -1, -1, 1 },
        {
            { 2, 1, 1, -1 },
            { -1, 1, -2, 2 },
            { -1, -2, 1, 2 }
        }
    },
    face<3> {
        { -1, 1, 1, -1 },
        {
            { 2, 1, 1, -1 },
            { -1, 1, -2, 2 },
            { -1, -2, 1, 2 }
        }
    },
    face<3> {
        { -1, 1, 0, 0 },
        {
            { 1, 1, 2, -2 },
            { 0, 0, -2, 2 },
            { -1, -1, 0, 2 }
        }
    },
    face<3> {
        { 1, -1, 0, 0 },
        {
            { 1, 1, 2, -2 },
            { 0, 0, -2, 2 },
            { -1, -1, 0, 2 }
        }
    },
    face<3> {
        { -1, 0, 1, 0 },
        {
            { 0, 2, 0, 0 },
            { -1, 0, -1, 2 },
            { 1, -2, 1, 0 }
        }
    },
    face<3> {
        { 1, 0, -1, 0 },
        {
            { 0, 2, 0, 0 },
            { -1, 0, -1, 2 },
            { 1, -2, 1, 0 }
        }
    },
    face<3> {
        { -1, 0, 0, 1 },
        {
            { 0, 1, 0, 0 },
            { 0, 0, -1, 1 },
            { 0, -1, 1, 0 }
        }
    },
    face<3> {
        { 1, 0, 0, -1 },
        {
            { 0, 1, 0, 0 },
            { 0, 0, -1, 1 },
            { 0, -1, 1, 0 }
        }
    },
    face<3> {
        { -1, 0, 1, 0 },
        {
            { 1, 2, 1, -2 },
            { -1, 0, -1, 2 },
            { 0, -2, 0, 2 }
        }
    },
    face<3> {
        { 1, 0, -1, 0 },
        {
            { 1, 2, 1, -2 },
            { -1, 0, -1, 2 },
            { 0, -2, 0, 2 }
        }
    },
    face<3> {
        { -1, 0, 0, 1 },
        {
            { 0, 1, 1, -1 },
            { 0, 0, -1, 1 },
            { 0, -1, 0, 1 }
        }
    },
    face<3> {
        { 1, 0, 0, -1 },
        {
            { 0, 1, 1, -1 },
            { 0, 0, -1, 1 },
            { 0, -1, 0, 1 }
        }
    },
    face<3> {
        { 0, 0, -1, 1 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 1, -1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, -1 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 1, -1, 0, 0 }
        }
    },
    face<3> {
        { 0, 1, -1, 0 },
        {
            { 2, 0, 0, 0 },
            { 0, -1, -1, 2 },
            { -2, 1, 1, 0 }
        }
    },
    face<3> {
        { 0, -1, 1, 0 },
        {
            { 2, 0, 0, 0 },
            { 0, -1, -1, 2 },
            { -2, 1, 1, 0 }
        }
    },
    face<3> {
        { 0, 1, -1, 0 },
        {
            { 2, 1, 1, -2 },
            { 0, -1, -1, 2 },
            { -2, 0, 0, 2 }
        }
    },
    face<3> {
        { 0, -1, 1, 0 },
        {
            { 2, 1, 1, -2 },
            { 0, -1, -1, 2 },
            { -2, 0, 0, 2 }
        }
    },
    face<3> {
        { 0, 1, 0, -1 },
        {
            { 1, 0, 0, 0 },
            { 0, 0, -1, 1 },
            { -1, 0, 1, 0 }
        }
    },
    face<3> {
        { 0, -1, 0, 1 },
        {
            { 1, 0, 0, 0 },
            { 0, 0, -1, 1 },
            { -1, 0, 1, 0 }
        }
    },
    face<3> {
        { 0, 1, 0, -1 },
        {
            { 1, 0, 1, -1 },
            { 0, 0, -1, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, -1, 0, 1 },
        {
            { 1, 0, 1, -1 },
            { 0, 0, -1, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, 0, -1, 1 },
        {
            { 1, 0, 0, 0 },
            { 0, -1, 0, 1 },
            { -1, 1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, 1, -1 },
        {
            { 1, 0, 0, 0 },
            { 0, -1, 0, 1 },
            { -1, 1, 0, 0 }
        }
    },
    face<3> {
        { 0, 0, -1, 1 },
        {
            { 1, 1, 0, -1 },
            { 0, -1, 0, 1 },
            { -1, 0, 0, 1 }
        }
    },
    face<3> {
        { 0, 0, 1, -1 },
        {
            { 1, 1, 0, -1 },
            { 0, -1, 0, 1 },
            { -1, 0, 0, 1 }
        }
    }
};

static const face<4> rectangles[24] = {
    face<4> {
        { 0, 0, -1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 0, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 0, 1, 0 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 0, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 0, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, -1, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 0, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 1, 1, -1 },
        {
            { 0, -1, 1, 1 },
            { -2, 0, 0, 2 },
            { 0, 1, -1, 1 },
            { 2, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, -1, -1, 1 },
        {
            { 0, -1, 1, 1 },
            { -2, 0, 0, 2 },
            { 0, 1, -1, 1 },
            { 2, 0, 0, 0 }
        }
    },
    face<4> {
        { -1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 0, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<4> {
        { 1, 0, 0, 0 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 0, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<4> {
        { -1, 0, -1, 1 },
        {
            { -1, 0, 1, 1 },
            { 0, -2, 0, 2 },
            { 1, 0, -1, 1 },
            { 0, 2, 0, 0 }
        }
    },
    face<4> {
        { 1, 0, 1, -1 },
        {
            { -1, 0, 1, 1 },
            { 0, -2, 0, 2 },
            { 1, 0, -1, 1 },
            { 0, 2, 0, 0 }
        }
    },
    face<4> {
        { -1, -1, 0, 1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, 0, 1 },
            { 0, 0, -2, 2 },
            { -1, 1, 0, 1 }
        }
    },
    face<4> {
        { 1, 1, 0, -1 },
        {
            { 0, 0, 2, 0 },
            { 1, -1, 0, 1 },
            { 0, 0, -2, 2 },
            { -1, 1, 0, 1 }
        }
    },
    face<4> {
        { -1, 1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, 0, 2 },
            { 0, 0, -2, 2 },
            { 1, 1, 0, 0 }
        }
    },
    face<4> {
        { 1, -1, 0, 0 },
        {
            { 0, 0, 2, 0 },
            { -1, -1, 0, 2 },
            { 0, 0, -2, 2 },
            { 1, 1, 0, 0 }
        }
    },
    face<4> {
        { -1, 0, 1, 0 },
        {
            { 1, 0, 1, 0 },
            { 0, -2, 0, 2 },
            { -1, 0, -1, 2 },
            { 0, 2, 0, 0 }
        }
    },
    face<4> {
        { 1, 0, -1, 0 },
        {
            { 1, 0, 1, 0 },
            { 0, -2, 0, 2 },
            { -1, 0, -1, 2 },
            { 0, 2, 0, 0 }
        }
    },
    face<4> {
        { -1, 0, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 0, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<4> {
        { 1, 0, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { 0, -1, 0, 1 },
            { 0, 0, -1, 1 },
            { 0, 1, 0, 0 }
        }
    },
    face<4> {
        { 0, 1, -1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, 0, 0, 2 },
            { 0, -1, -1, 2 },
            { 2, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, -1, 1, 0 },
        {
            { 0, 1, 1, 0 },
            { -2, 0, 0, 2 },
            { 0, -1, -1, 2 },
            { 2, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 1, 0, -1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 0, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, -1, 0, 1 },
        {
            { 0, 0, 1, 0 },
            { -1, 0, 0, 1 },
            { 0, 0, -1, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 0, -1, 1 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 0, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    },
    face<4> {
        { 0, 0, 1, -1 },
        {
            { 0, 1, 0, 0 },
            { -1, 0, 0, 1 },
            { 0, -1, 0, 1 },
            { 1, 0, 0, 0 }
        }
    }
};

static const shape shapes[256] = {
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 0, 1 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 2, 3 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 4, 5 },
        { }
    },
    shape {
        { 6, 7 },
        { }
    },
    shape {
        { },
        { 0, 1 }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 8, 9 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 10, 11 },
        { }
    },
    shape {
        { 12, 13 },
        { }
    },
    shape {
        { 0, 9, 10, 13 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 14, 15 },
        { }
    },
    shape {
        { 16, 17 },
        { }
    },
    shape {
        { 2, 9, 14, 17 },
        { }
    },
    shape {
        { 18, 19 },
        { }
    },
    shape {
        { 4, 10, 15, 18 },
        { }
    },
    shape {
        { 6, 12, 17, 18 },
        { }
    },
    shape {
        { 9, 10, 17, 18 },
        { 0 }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 20, 21 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 22, 23 },
        { }
    },
    shape {
        { 24, 25 },
        { }
    },
    shape {
        { 0, 21, 22, 25 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 26, 27 },
        { }
    },
    shape {
        { 28, 29 },
        { }
    },
    shape {
        { 2, 21, 26, 29 },
        { }
    },
    shape {
        { 30, 31 },
        { }
    },
    shape {
        { 4, 22, 27, 30 },
        { }
    },
    shape {
        { 6, 24, 29, 30 },
        { }
    },
    shape {
        { 21, 22, 29, 30 },
        { 0 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 32, 33 },
        { }
    },
    shape {
        { 34, 35 },
        { }
    },
    shape {
        { },
        { 2, 3 }
    },
    shape {
        { 36, 37 },
        { }
    },
    shape {
        { 33, 10, 23, 36 },
        { }
    },
    shape {
        { 35, 12, 25, 36 },
        { }
    },
    shape {
        { 0, 10, 25, 36 },
        { 3 }
    },
    shape {
        { 38, 39 },
        { }
    },
    shape {
        { 33, 14, 27, 38 },
        { }
    },
    shape {
        { 35, 16, 29, 38 },
        { }
    },
    shape {
        { 2, 14, 29, 38 },
        { 3 }
    },
    shape {
        { },
        { 4, 5 }
    },
    shape {
        { 4, 33, 10, 27 },
        { 4 }
    },
    shape {
        { 6, 35, 12, 29 },
        { 4 }
    },
    shape {
        { 10, 29 },
        { 0, 3, 4 }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 40, 41 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 42, 43 },
        { }
    },
    shape {
        { 44, 45 },
        { }
    },
    shape {
        { 0, 41, 42, 45 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 46, 47 },
        { }
    },
    shape {
        { 48, 49 },
        { }
    },
    shape {
        { 2, 41, 46, 49 },
        { }
    },
    shape {
        { 50, 51 },
        { }
    },
    shape {
        { 4, 42, 47, 50 },
        { }
    },
    shape {
        { 6, 44, 49, 50 },
        { }
    },
    shape {
        { 41, 42, 49, 50 },
        { 0 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 52, 53 },
        { }
    },
    shape {
        { 54, 55 },
        { }
    },
    shape {
        { 9, 40, 52, 55 },
        { }
    },
    shape {
        { 56, 57 },
        { }
    },
    shape {
        { },
        { 6, 7 }
    },
    shape {
        { 56, 12, 45, 55 },
        { }
    },
    shape {
        { 0, 9, 45, 55 },
        { 6 }
    },
    shape {
        { 58, 59 },
        { }
    },
    shape {
        { 52, 15, 46, 59 },
        { }
    },
    shape {
        { },
        { 8, 9 }
    },
    shape {
        { 2, 9, 52, 46 },
        { 9 }
    },
    shape {
        { 56, 59, 19, 50 },
        { }
    },
    shape {
        { 4, 15, 59, 50 },
        { 6 }
    },
    shape {
        { 6, 56, 12, 50 },
        { 9 }
    },
    shape {
        { 9, 50 },
        { 0, 6, 9 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 60, 61 },
        { }
    },
    shape {
        { 62, 63 },
        { }
    },
    shape {
        { 21, 40, 61, 63 },
        { }
    },
    shape {
        { 64, 65 },
        { }
    },
    shape {
        { 42, 23, 61, 65 },
        { }
    },
    shape {
        { },
        { 10, 11 }
    },
    shape {
        { 0, 21, 42, 61 },
        { 11 }
    },
    shape {
        { 66, 67 },
        { }
    },
    shape {
        { 27, 46, 61, 66 },
        { }
    },
    shape {
        { 62, 48, 29, 66 },
        { }
    },
    shape {
        { 2, 21, 46, 61, 29, 66 },
        { }
    },
    shape {
        { 64, 31, 50, 66 },
        { }
    },
    shape {
        { 4, 42, 27, 61, 50, 66 },
        { }
    },
    shape {
        { 6, 29, 50, 66 },
        { 10 }
    },
    shape {
        { 21, 42, 61, 29, 50, 66 },
        { 0 }
    },
    shape {
        { 68, 69 },
        { }
    },
    shape {
        { 33, 52, 60, 69 },
        { }
    },
    shape {
        { 35, 63, 54, 69 },
        { }
    },
    shape {
        { 40, 52, 63, 69 },
        { 3 }
    },
    shape {
        { 56, 65, 37, 69 },
        { }
    },
    shape {
        { 33, 23, 65, 69 },
        { 6 }
    },
    shape {
        { 35, 56, 12, 69 },
        { 11 }
    },
    shape {
        { 0, 69 },
        { 3, 6, 11 }
    },
    shape {
        { 58, 39, 66, 69 },
        { }
    },
    shape {
        { 33, 52, 27, 46, 66, 69 },
        { }
    },
    shape {
        { 35, 29, 66, 69 },
        { 8 }
    },
    shape {
        { 2, 52, 46, 29, 66, 69 },
        { 3 }
    },
    shape {
        { 56, 50, 66, 69 },
        { 5 }
    },
    shape {
        { 4, 33, 27, 50, 66, 69 },
        { 6 }
    },
    shape {
        { 6, 35, 56, 12, 29, 50, 66, 69 },
        { }
    },
    shape {
        { 29, 50, 66, 69 },
        { 0, 3, 6 }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 70, 71 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 72, 73 },
        { }
    },
    shape {
        { 74, 75 },
        { }
    },
    shape {
        { 0, 71, 72, 75 },
        { }
    },
    shape {
        { },
        { }
    },
    shape {
        { 76, 77 },
        { }
    },
    shape {
        { 78, 79 },
        { }
    },
    shape {
        { 2, 71, 76, 79 },
        { }
    },
    shape {
        { 80, 81 },
        { }
    },
    shape {
        { 4, 72, 77, 80 },
        { }
    },
    shape {
        { 6, 74, 79, 80 },
        { }
    },
    shape {
        { 71, 72, 79, 80 },
        { 0 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 82, 83 },
        { }
    },
    shape {
        { 84, 85 },
        { }
    },
    shape {
        { 9, 70, 82, 84 },
        { }
    },
    shape {
        { 86, 87 },
        { }
    },
    shape {
        { 10, 73, 83, 87 },
        { }
    },
    shape {
        { 12, 75, 84, 87 },
        { }
    },
    shape {
        { 0, 9, 10, 75, 84, 87 },
        { }
    },
    shape {
        { 88, 89 },
        { }
    },
    shape {
        { },
        { 12, 13 }
    },
    shape {
        { 88, 16, 79, 84 },
        { }
    },
    shape {
        { 2, 9, 79, 84 },
        { 12 }
    },
    shape {
        { 89, 19, 80, 87 },
        { }
    },
    shape {
        { 4, 10, 80, 87 },
        { 13 }
    },
    shape {
        { 6, 12, 79, 84, 80, 87 },
        { }
    },
    shape {
        { 9, 10, 79, 84, 80, 87 },
        { 0 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 90, 91 },
        { }
    },
    shape {
        { 92, 93 },
        { }
    },
    shape {
        { 21, 70, 90, 93 },
        { }
    },
    shape {
        { 94, 95 },
        { }
    },
    shape {
        { },
        { 14, 15 }
    },
    shape {
        { 94, 24, 75, 93 },
        { }
    },
    shape {
        { 0, 21, 75, 93 },
        { 14 }
    },
    shape {
        { 96, 97 },
        { }
    },
    shape {
        { 90, 76, 27, 97 },
        { }
    },
    shape {
        { },
        { 16, 17 }
    },
    shape {
        { 2, 21, 90, 76 },
        { 17 }
    },
    shape {
        { 94, 97, 31, 80 },
        { }
    },
    shape {
        { 4, 27, 97, 80 },
        { 14 }
    },
    shape {
        { 6, 94, 24, 80 },
        { 17 }
    },
    shape {
        { 21, 80 },
        { 0, 14, 17 }
    },
    shape {
        { 98, 99 },
        { }
    },
    shape {
        { 33, 91, 82, 99 },
        { }
    },
    shape {
        { 35, 93, 85, 99 },
        { }
    },
    shape {
        { 70, 82, 93, 99 },
        { 3 }
    },
    shape {
        { 95, 37, 87, 99 },
        { }
    },
    shape {
        { 33, 10, 87, 99 },
        { 15 }
    },
    shape {
        { 35, 12, 75, 93, 87, 99 },
        { }
    },
    shape {
        { 0, 10, 75, 93, 87, 99 },
        { 3 }
    },
    shape {
        { 88, 97, 39, 99 },
        { }
    },
    shape {
        { 33, 27, 97, 99 },
        { 12 }
    },
    shape {
        { 35, 88, 16, 99 },
        { 17 }
    },
    shape {
        { 2, 99 },
        { 3, 12, 17 }
    },
    shape {
        { 97, 80, 87, 99 },
        { 5 }
    },
    shape {
        { 4, 33, 10, 27, 97, 80, 87, 99 },
        { }
    },
    shape {
        { 6, 35, 12, 80, 87, 99 },
        { 17 }
    },
    shape {
        { 10, 80, 87, 99 },
        { 0, 3, 17 }
    },
    shape {
        { },
        { }
    },
    shape {
        { 100, 101 },
        { }
    },
    shape {
        { 102, 103 },
        { }
    },
    shape {
        { },
        { 18, 19 }
    },
    shape {
        { 104, 105 },
        { }
    },
    shape {
        { 101, 42, 73, 104 },
        { }
    },
    shape {
        { 103, 44, 75, 104 },
        { }
    },
    shape {
        { 0, 42, 75, 104 },
        { 19 }
    },
    shape {
        { 106, 107 },
        { }
    },
    shape {
        { 101, 77, 46, 106 },
        { }
    },
    shape {
        { 103, 48, 79, 106 },
        { }
    },
    shape {
        { 2, 46, 79, 106 },
        { 19 }
    },
    shape {
        { },
        { 20, 21 }
    },
    shape {
        { 4, 101, 42, 77 },
        { 20 }
    },
    shape {
        { 6, 103, 44, 79 },
        { 20 }
    },
    shape {
        { 42, 79 },
        { 0, 19, 20 }
    },
    shape {
        { 108, 109 },
        { }
    },
    shape {
        { 100, 52, 83, 109 },
        { }
    },
    shape {
        { 102, 54, 84, 109 },
        { }
    },
    shape {
        { 9, 52, 84, 109 },
        { 18 }
    },
    shape {
        { 56, 104, 86, 109 },
        { }
    },
    shape {
        { 73, 83, 104, 109 },
        { 6 }
    },
    shape {
        { 56, 12, 75, 84, 104, 109 },
        { }
    },
    shape {
        { 0, 9, 75, 84, 104, 109 },
        { 6 }
    },
    shape {
        { 89, 58, 106, 109 },
        { }
    },
    shape {
        { 52, 46, 106, 109 },
        { 13 }
    },
    shape {
        { 79, 84, 106, 109 },
        { 8 }
    },
    shape {
        { 2, 9, 52, 46, 79, 84, 106, 109 },
        { }
    },
    shape {
        { 56, 89, 19, 109 },
        { 20 }
    },
    shape {
        { 4, 109 },
        { 6, 13, 20 }
    },
    shape {
        { 6, 56, 12, 79, 84, 109 },
        { 20 }
    },
    shape {
        { 9, 79, 84, 109 },
        { 0, 6, 20 }
    },
    shape {
        { 110, 111 },
        { }
    },
    shape {
        { 100, 91, 61, 111 },
        { }
    },
    shape {
        { 102, 62, 93, 111 },
        { }
    },
    shape {
        { 21, 61, 93, 111 },
        { 18 }
    },
    shape {
        { 95, 64, 104, 111 },
        { }
    },
    shape {
        { 42, 61, 104, 111 },
        { 15 }
    },
    shape {
        { 75, 93, 104, 111 },
        { 10 }
    },
    shape {
        { 0, 21, 42, 61, 75, 93, 104, 111 },
        { }
    },
    shape {
        { 97, 106, 67, 111 },
        { }
    },
    shape {
        { 27, 46, 61, 97, 106, 111 },
        { }
    },
    shape {
        { 62, 48, 106, 111 },
        { 17 }
    },
    shape {
        { 2, 21, 46, 61, 106, 111 },
        { 17 }
    },
    shape {
        { 64, 97, 31, 111 },
        { 20 }
    },
    shape {
        { 4, 42, 27, 61, 97, 111 },
        { 20 }
    },
    shape {
        { 6, 111 },
        { 10, 17, 20 }
    },
    shape {
        { 21, 42, 61, 111 },
        { 0, 17, 20 }
    },
    shape {
        { },
        { 22, 23 }
    },
    shape {
        { 33, 100, 52, 91 },
        { 23 }
    },
    shape {
        { 35, 102, 54, 93 },
        { 23 }
    },
    shape {
        { 52, 93 },
        { 3, 18, 23 }
    },
    shape {
        { 56, 95, 37, 104 },
        { 23 }
    },
    shape {
        { 33, 104 },
        { 6, 15, 23 }
    },
    shape {
        { 35, 56, 12, 75, 93, 104 },
        { 23 }
    },
    shape {
        { 0, 75, 93, 104 },
        { 3, 6, 23 }
    },
    shape {
        { 58, 97, 39, 106 },
        { 23 }
    },
    shape {
        { 33, 52, 27, 46, 97, 106 },
        { 23 }
    },
    shape {
        { 35, 106 },
        { 8, 17, 23 }
    },
    shape {
        { 2, 52, 46, 106 },
        { 3, 17, 23 }
    },
    shape {
        { 56, 97 },
        { 5, 20, 23 }
    },
    shape {
        { 4, 33, 27, 97 },
        { 6, 20, 23 }
    },
    shape {
        { 6, 35, 56, 12 },
        { 17, 20, 23 }
    },
    shape {
        { },
        { 0, 3, 6, 17, 20, 23 }
    }
};

}

#endif
